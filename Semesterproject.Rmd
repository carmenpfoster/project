---
title: The influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland
subtitle: GEO880 Computational Movement Analysis
author: Vibiga Vinotharajah and Carmen Pfoster
output: 
  html_document:
    toc: true
    toc_float: true
---


## Abstract

An important factor, which affects environmental conditions of animals, is weather. A few studies show that wild boar decrease their movement at low temperatures and increase their movement in late summer. By studying wild boar movement, we analysed the influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland. With our analysis, we found out that the weather conditions indeed play a role in the wild boar movement. The wild boars increase their movement at higher temperatures and during summer precipitation and decrease their movement at low temperatures. We also confirm the previous studies that winter precipitation, e.g. snow falls, reduce movement of wild boars.


## Introduction

Interactions between different factors can have consequences for population dynamics, species distribution and individual fitness, which are the result of animal movement decisions. Nowadays it is possible to capture spatial behaviour through modern technology such as GPS-System. On one hand, such data give insights into movement patterns on different scales and on the other hand enable a better understanding of the effects of different contexts on spatial behaviour (Morelle et al. 2014: 16).

An important factor, which affects the environmental conditions of animals and therefore the animal movement, is weather (Thurfjell et al. 2014: 467). The weather can influence the mobility, the food availability, or the energetic demands of animals. There are a few studies which analyse the effects of weather on wild boar movement (Thurjfell et al. 2014; Lemel et al. 2003; Morelle et al. 2015). 

In this project, we aim to analyse the effects of weather on wild boar movement in the year 2014. According to different studies (Thurfjell et al. 2014; Morelle et al. 2015), wild boar movement is expected to be affected by weather factors. Wild boar is an omnivorous mammal mostly ranging in border zones between pastures and forests (Lemel et al. 2003: 29). In human-dominated landscapes wild boar move less during the day than during the night (Thurfjell et al. 2014: 467). Apart from that cold weather increases the movement in the night, which means a higher demand of energy used (Lemel et al. 2003: 32). In times of snow cover, wild boars decrease their movement duration and distance (Thurfjell et al. 2014: 468). Precipitation increases the movement duration and distance (Morelle et al. 2015: 20). Different studies show that there are effects of weather on wild boar movement. Most of these studies used wild boar movement data from Sweden (Thurjfell et al. 2014; Lemel et al. 2003). Since the wild boar movement data, provided for this project, is from Switzerland, the aim of this project is to analyse the influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland. Thus, the research question for this study is: “Is there a seasonal difference in the wild boar moving pattern (clustering vs. moving) but also regarding the location and properties of their habitat?”.


```{r loading packages, echo = FALSE, warning = FALSE, message = FALSE}
library(ComputationalMovementAnalysisData)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(sf)
library(lubridate)
library(adehabitatHR)
library(adehabitatLT)
library(tmap)
library(readr)
tmap_mode("view")

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

``` {r loading wildboar data}
# Include tables with the function "kable"
knitr::kable(head(wildschwein_BE))

#loading wildboar data
wildschwein <- wildschwein_BE
wildschwein <- st_as_sf(wildschwein,
                        coords = c("E", "N"), 
                        crs = 2056,
                        remove = FALSE)
```

## Literature Review
Since there are some studies, which already analysed the effects of weather on wild boar movement, it is important to discuss and present the main statements of them.
In 1986, Dardaillon conducted a study with wild boar from the Southern France (Dardaillon 1986). The author analysed the seasonal habitat selection and use by wild boars in relation to six habitat types (Dardaillon 1986: 251). In his study, the author discussed with his results that the estimated autumn to spring density is higher than the summer one (Dardaillon 1986: 264). In the summer season, wild boars tend to emigrate to agricultural crops because of what their movement is higher in warm season. Dardaillon does not focus on the effects of weather on wild boar, but this study shows that there are seasonal changes which influence the wild boar movement.
Morelle et al. reviewed the literature on wild boar movement ecology with a movement ecology framework. In their review they try to increase the knowledge of the drivers and mechanisms of the spatial behaviour of wild boar (Morelle et al. 2015: 16). In this study, it is stated that to find out where and when the wild boars move external factors, for example seasonality of resources, must be considered (Morelle et al. 2015: 19-20). The study discusses that wild boar can adapt to the seasonality of food resources, where the reduce their movement and home range in masting trees rich areas in autumn (Morelle et al. 2015: 20). Furthermore, Morelle and his colleagues present in a table that wild boar movement decreases at low temperatures, there is increased activity in humid air conditions and snow cover limits the wild boar movement at local and regional levels (Morelle et al. 2015: 23).
The study from Thurfjell and his colleagues (2014) discuss the effects of weather on movement of wild boars in Sweden. They used weather data, especially temperature, precipitation, and snow depth. The seasons were divided into five different seasons, where they divided summer into early and late summer (Thurfjell 2014: 468). The results from their study show that wild boar decrease their movement in precipitation during winter and at low temperatures. Wild boar increased their movement in the late summer season. Here one can see that Morelle and his colleagues’ reviews literature about weather effects on wild boar movement stated the same arguments (2015: 20). 

## Material and Methods

The following analysis is mainly based on the wild boar data set provided by the ZHAW. Between May 2014 and October 2016 18 different wild boars were tracked with GPS collars in the area between Lake Neuchâtel and Lake Biel. Generally, the location was recorded every 15 minutes. In addition to the time stamp and the coordinates, the moonillumination was indicated for every measurement as well but this information was not used in this study. 

As the goal of this research is to analyze the influence of weather and season on the movement patterns of wild boar the following additional data was used:
- Mean daily temperature [°C] of two weather stations (Neuchâtel and Cressier)
- daily precipitation [mm] of the same two weather stations
Both datasets were accessed via the IDAweb portal of the Federal Office of Meteorology and Climatology MeteoSwiss.

On ??? Figure ??? one can see the whole study area and the two locations of the weather stations.

```{r assigning season}
#assigning season to each measurement point
wildschwein <- wildschwein %>% 
  mutate(Month = format(as.Date(DatetimeUTC), "%m"))
  
wildschwein <- wildschwein %>% 
  mutate(season = ifelse(wildschwein$Month == "12" | wildschwein$Month == "01" | wildschwein$Month == "02", "winter",
                    ifelse(wildschwein$Month == "03" | wildschwein$Month == "04" | wildschwein$Month == "05", "spring",
                    ifelse(wildschwein$Month == "06" | wildschwein$Month == "07" | wildschwein$Month == "08", "summer",
                    ifelse(wildschwein$Month == "09" | wildschwein$Month == "10" | wildschwein$Month == "11", "autumn", "no")))))
```

```{r loading weather data}
# Reading the weather data
weatherData <- read_delim("order_103728_data_temp.txt", delim = ";")
precipData <- read_delim("order_103873_data_precip.txt", delim = ";")
# Creating additional dataframe, based on the legend.txt for adding
# important info to our dataset

stn <- c("CRM","NEU")
stn_names <- c("Cressier","Neuchâtel")
koord_E <- c(7.067, 6.95)
koord_N <- c(47.05,47.00)
hoehe <- c(430,485) # in meters

legend <- data.frame(stn,stn_names,koord_E,koord_N,hoehe)
```

```{r}
# Joining the station and temperature dataframes
data_comb <- full_join(weatherData, legend, by="stn") %>% na.omit()
data_comb <- full_join(data_comb, precipData, by= c("stn","time")) %>% na.omit()

#removing unnecessary columns
data_comb <- subset(data_comb, select = -c(qtre200d0, mtre200d0))

# Converting to an sf object
data_sf <- st_as_sf(data_comb, coords = c("koord_E", "koord_N"), crs = 4326)
data_sf <- data_sf %>% 
  mutate(date = ymd(time)) %>% 
  mutate(tre200d0 = as.numeric(tre200d0)) %>% 
  mutate(rka150d0 = as.numeric(rka150d0))

data_sf_lv95 <- st_transform(data_sf, 2056)
```

```{r}
#Figure 1
wildschwein_smry <- summarise(wildschwein)

wildschwein_convex <- st_convex_hull(wildschwein_smry)

tm_shape(wildschwein_convex)+
  tm_polygons(col="blue", title='convex hull')+
  tm_shape(data_sf_lv95)+
  tm_dots(col="red", title='Weather station')+
  tm_layout(title= 'Figure 1: Overview of the measurement area')
```

For reasons of simplicity, the wild boar data was classified into the meteorological seasons, which always classifies the whole months into one season:

| Winter      | December, January, February  |
| Spring      | March, April, May            |
| Summer      | June, July, August           |
| Autumn      | September, October, November |

On the weather data some pre-processing was required too. To consider both meteo stations, the mean temperature and precipitation of the two measurements was calculated for every day. After that the weather data frame was joined to the wild boar data frame.

### Conceptualization of movement
Is there a seasonal difference in the wild boar moving pattern (clustering vs. moving)
To analyse the wild boar moving patterns two different approaches were implemented:

- To get an indicator for the total daily movement, the euclidean distance along all tracking locations per day was calculated for every individual wild boar. Then the total daily distance covered could be opposed to the temperature and precipitation as well as the seasons.
- For the analysis of the amount of clustering that happened per day, the trajectories were segmented, similarly to the segmentation in Exercise 3. For every point the distance to the three preceding and following points were calculated. The mean of these six distances can be seen as the mean step length. Then all mean step lengths were classified as static when they are below the mean step length of all mean step lengths. Then the ratio of static points in all point was calculated. This was then again opposed to the temperature and precipitation data and the season classification like the before described daily movement.


```{r}
# plots for presentations
#ueli <- filter(wildschwein, TierID == "1")
#sabine <- filter(wildschwein, TierID == "2")
#nicole <- filter(wildschwein, TierID == "5")


#ggplot(ueli, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Ueli (ID=1)")

#ggplot(sabine, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Sabine (ID=2)")
  
#ggplot(nicole, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Nicole (ID=5)")
```

```{r}
# plots for presentations
#tm_shape(ueli)+
  #tm_dots(col="season")

#tm_shape(sabine)+
 # tm_dots(col="season")

#tm_shape(nicole)+
 # tm_dots(col="season")
```


```{r}
data_sf_lv95 <- data_sf_lv95 %>% 
  group_by(date) %>% 
  mutate(temp = mean(tre200d0), precip = mean(rka150d0)) %>% 
  st_drop_geometry()

temp_precip <- data_sf_lv95 %>% 
  filter(stn == "CRM")

wildschwein <- wildschwein %>% 
  mutate(date = as.Date(DatetimeUTC))

wildschwein <- left_join(wildschwein, temp_precip, by = "date")
wildschwein <- subset(wildschwein, select = -c(tre200d0, rka150d0))
```

<!--
```{r, echo = FALSE, warning = FALSE, message = FALSE}
ueli <- filter(wildschwein, TierID == "1")
sabine <- filter(wildschwein, TierID == "2")
nicole <- filter(wildschwein, TierID == "5")

ggplot(ueli, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Ueli (ID=1)")

ggplot(sabine, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Sabine (ID=2)")
  
ggplot(nicole, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Nicole (ID=5)")

ggplot(ueli, aes(E,N, colour=precip)) +
  geom_point()+
  ggtitle("Movement of Ueli (ID=1)")

ggplot(sabine, aes(E,N, colour=precip)) +
  geom_point()+
  ggtitle("Movement of Sabine (ID=2)")
  
ggplot(nicole, aes(E,N, colour=precip)) +
  geom_point()+
  ggtitle("Movement of Nicole (ID=5)")
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#testing segmentation on ueli
ueli <- filter(wildschwein, TierID == "1")
ueli <- ueli %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),
    stepMean = rowMeans(                       
      cbind(                                   
        sqrt((lag(E,6)-E)^2+(lag(E,6)-E)^2),
        sqrt((lag(E,5)-E)^2+(lag(E,5)-E)^2),
        sqrt((lag(E,4)-E)^2+(lag(E,4)-E)^2),
        sqrt((lag(E,3)-E)^2+(lag(E,3)-E)^2),
        sqrt((lag(E,2)-E)^2+(lag(E,2)-E)^2),   
        sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),   
        sqrt((E-lead(E,1))^2+(E-lead(E,1))^2),  
        sqrt((E-lead(E,2))^2+(E-lead(E,2))^2),
        sqrt((E-lead(E,3))^2+(E-lead(E,3))^2),
        sqrt((E-lead(E,4))^2+(E-lead(E,4))^2),
        sqrt((E-lead(E,5))^2+(E-lead(E,5))^2),
        sqrt((E-lead(E,6))^2+(E-lead(E,6))^2)
        )                                        
    )
  )

summary(ueli$stepLength)

ggplot(ueli, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(ueli$stepLength,na.rm = TRUE))

ueli <- ueli %>%
  mutate(
    static = stepMean < mean(ueli$stepMean,na.rm = TRUE)
  ) 

ueli_dailysummary <- ueli %>% 
  group_by(time, season, temp, precip) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE),
            ratio = sum(static == TRUE)/(sum(static == TRUE)+ sum(static == FALSE)))
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
ueli1 = subset(ueli, time=="20140529")
ggplot(ueli1, aes(x = E, y = N, col = static)) +
  geom_point()+geom_path()
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# ueli temperature daily distance
ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

#ueli temperature static vs movement
ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance)) + geom_point()+labs(title = "scatterplot ueli without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio)) + geom_point()+labs(title = "scatterplot ueli without trend")
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#ueli precipitation daily distance
ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance)) + geom_point()+labs(title = "scatterplot ueli without trend")

#ueli precipitation ratio
ggplot(ueli_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=precip, y=ratio)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=precip, y=ratio)) + geom_point()+labs(title = "scatterplot ueli without trend")
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#ueli movement ratio and seasons
ggplot(ueli_dailysummary, aes(x=season, y = ratio))+
  geom_point()
```
-->

```{r}
# calculating steplength for every wild boar (euclidean distance between sampling points)
wildschwein_steplength <- wildschwein %>% 
  group_by(TierID) %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),
    stepMean = rowMeans(                       
      cbind(                                   
        sqrt((lag(E,6)-E)^2+(lag(E,6)-E)^2),
        sqrt((lag(E,5)-E)^2+(lag(E,5)-E)^2),
        sqrt((lag(E,4)-E)^2+(lag(E,4)-E)^2),
        sqrt((lag(E,3)-E)^2+(lag(E,3)-E)^2),   
        sqrt((lag(E,2)-E)^2+(lag(E,2)-E)^2),   
        sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),   
        sqrt((E-lead(E,1))^2+(E-lead(E,1))^2),  
        sqrt((E-lead(E,2))^2+(E-lead(E,2))^2),
        sqrt((E-lead(E,3))^2+(E-lead(E,3))^2),
        sqrt((E-lead(E,4))^2+(E-lead(E,4))^2),
        sqrt((E-lead(E,5))^2+(E-lead(E,5))^2),
        sqrt((E-lead(E,6))^2+(E-lead(E,6))^2)
        )                                        
    )
  )

summary(wildschwein_steplength$stepLength)

#histogram steplength, line == mean
ggplot(wildschwein_steplength, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(wildschwein_steplength$stepLength,na.rm = TRUE))

#steplength < mean steplength --> static (to be discussed!!)
wildschwein_steplength <- wildschwein_steplength %>%
  mutate(
    static = stepMean < mean(wildschwein_steplength$stepMean,na.rm = TRUE)
  ) 

#calculating daily distance per wild boar --> Achtung: Annahme dass alle regelmässige Messungen über den gesamten Tag haben (wurde noch nicht geprüft)
wildschwein_dailysummary <- wildschwein_steplength %>% 
  group_by(TierID, time, season, temp, precip) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE),
            ratio = sum(static == TRUE)/(sum(static == TRUE)+ sum(static == FALSE)))
```

<!--
```{r, echo = FALSE, warning = FALSE, message = FALSE}
# all wild boar temperature daily distance
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")

#all wild boar temperature ratio
ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
#all wild boar precipitation daily distance
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")

#all wild boar precipitation ratio
ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")
```


```{r, echo = FALSE, warning = FALSE, message = FALSE}
# übersicht temperature und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# übersicht precipitation und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```


```{r, echo = FALSE, warning = FALSE, message = FALSE}
# einzelner plot pro wildschwein in gross (gleicher input wie oben mit facet_wrap)
#vielleicht sieht man so spannende Muster besser
wild_boars <- c(unique(wildschwein_dailysummary$TierID))

for (i in wild_boars){
  subs <- subset(wildschwein_dailysummary, TierID == i) %>% 
  ggplot(aes(x=temp, y=daily_distance, col=season))+geom_point()+labs(title = "TierID", subtitle = as.character(i))
  print(subs)
}
```
-->


## Results

```{r}
#boxplot daily distance season
ggplot(wildschwein_dailysummary, aes(x = season, y = daily_distance)) + 
  geom_boxplot()
```

This simple boxplot represents the daily distance, how far the wild boars moved, in each season without including the temperature. One can see that the daily distance is farer in autumn and summer compared to winter especially.


```{r}
#boxplot movement ratio and seasons
ggplot(wildschwein_dailysummary, aes(x=season, y = ratio))+
  geom_boxplot()
```

This boxplot shows the ratios from each season. If the ratio is closer to 1 then there is more clustering in the movement than if the ratio is closer to 0. Autumn and winter have the same ratio, but it is important to highlight that in winter the variance is bigger than in the other seasons. The reason is that there is not much data available for winter. The higher the static values are and thus the ratio is bigger, the higher is the clustering. Considering this the season spring has the most clustering from all seasons.


```{r}
# all wild boar temperature daily distance
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")
```

In this plot one can see the difference between the daily distance per seasons depending on the temperature. The season summer represents more daily distance from wild boars with higher temperatures. Winter shows less daily distance with lower temperature and higher daily distance with higher temperatures. The increase in the season winter is higher than in the season summer, which is represented with the trend lines. In other words, 1 degree warmer in winter has a bigger influence on the movement of wild boars than in other seasons. The season autumn has the most daily distances between the temperatures 0 and 20 degrees. Additionally, the plot shows that with warmer temperatures the daily distances are higher.


```{r}
# übersicht temperature und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```

Looking at each plot from every wild boar, the plots represent how different the movement from each wild boar is. For example, the “TierID 1” wild boar moves a lot in summer and in winter there is almost no movement. “TierID 10” moves a lot in almost every season. Moreover, wild boars with more data points have a bigger influence on the whole regarding the seasons than individual wild boars. Also, the plot shows in the whole that in summer there is more movement than in other seasons.


?? Scatterplot all wild boars with trend per season (ratio/temp)




```{r}
#all wild boar precipitation daily distance
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")
```

In this plot the precipitation is analysed in connection to daily distance. The precipitation data has lots of 0 precipitation data, which is represented in the trend lines per season. However, one can see that the movement from wild boars is higher in autumn. With higher precipitation the movement in winter increases whereas in summer decreases.


```{r}
# übersicht precipitation und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```

Here the precipitation and the daily distance for each wild boar is represented individually. Again the 0 precipitation data points are clearly visible and some data points with higher precipitation. In the whole the plots represent that the wild boars are more active in summer precipitation than in winter. If we look at the wild boar individually, one can see that some wild boars only move in winter precipitation and others mostly in summer precipitation. In autumn the precipitation is closer to 0 and because of that the daily distance is higher, whereas in winter the daily distance is lower.


individual plots of wild boar (habitat)

```{r}
# determining animal with most measurements
wildschwein_count <- wildschwein_steplength %>%
  st_drop_geometry() %>% 
  group_by(TierName) %>% 
  summarise(n_of_measurements = n())

knitr::kable(wildschwein_count)

ggplot(wildschwein_count, aes(x=TierName, y=n_of_measurements)) +
  geom_bar(stat="identity")
```

```{r}
#analysing habitat for the three wild boars with the most measurement points

most_measured <- filter(wildschwein_steplength, TierName == "Amos" | TierName == "Caroline" | TierName == "Miriam")

amos <- filter(most_measured, TierName == "Amos")
caroline <- filter(most_measured, TierName == "Caroline")
miriam <- filter(most_measured, TierName == "Miriam")
```

```{r}
# individual analysis clustering vs. moving
tm_shape(amos) +
  tm_dots(col = "static")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(caroline) +
  tm_dots(col = "static")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(miriam) +
  tm_dots(col = "static")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```


```{r}
#individual analysis season
tm_shape(amos) +
  tm_dots(col = "season")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(caroline) +
  tm_dots(col = "season")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(miriam) +
  tm_dots(col = "season")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```

```{r}
#individual analysis temperature
tm_shape(amos) +
  tm_dots(col = "temp")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(caroline) +
  tm_dots(col = "temp")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(miriam) +
  tm_dots(col = "temp")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```


```{r}
tm_shape(amos) +
  tm_dots(col = "precip")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(caroline) +
  tm_dots(col = "precip")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")

tm_shape(miriam) +
  tm_dots(col = "precip")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```



## Discussion

The results show that there is an influence of temperature and precipitation in the wild boar movement, where especially the seasonal difference between summer and winter stands out compared to the seasons autumn and spring. CLUSTERING vs. MOVING. 
Wild boars moved more in summer times compared to the other seasons throughout the year. With higher temperature wild boar move more. As soon as winter gets warmer with some temperatures, the wild boars move more. However, in summer the wild boar movement remain constant with increasing temperatures. One can think here that in winter one degree warmer will be notices faster than in summer. The reduced movement in winter could be the reason for preserving the energy (Thurfjell et al. 2014: 470). These results were already studied from other authors, which were discussed in the literature review chapter. But a reason why our findings are not clear enough could be that compared to the other studies, our research has wild boar data from Switzerland, where the weather cannot be compared with other countries and their respecting wild boars. Additionally, the year in which the wild boars were detected may have less seasonal differences, for example snow fall in spring.
Precipitation generally caused increased movement in summer season and decreased movement during winter season. A suggested explanation may be that winter precipitation holds on for a longer time whereas summer precipitation holds on for a short period of time. Additionally, winter precipitation increases the effect of cold weather (Thurfjell et al. 2014: 470). As Morelle et al. discussed (2015: 23) because of the snow depth in winter the wild boar movement decreases. Overall, the findings from precipitation reassure that wild boars move less in winter and increase their movement in summer. 
Individual wild boar data show that not all wild boars move a lot in the season of summer. Some wild boars move a lot in other seasons such as in autumn but looking at the results collectively summer is dominating with the high daily distances.


## References
Dardaillon, M. (1986): Seasonal Variations in Habitat Selection and Spatial Distribution of Wild Boar (Sus Scrofa) in the Camargue, Southern France. Behavioural Processes, 13, 251-268.

Lemel, J., Truve, J.& Soderberg, B. (2003): Variation in ranging and activity behaviour of European wild boar Sus scrofa in Sweden. Wildl Biol 9, 29–36.Mammal Review, 45, 15-29.

Morelle, K. Podgroski, T., Prévot, C., Keuling, O., Lehaire, F. & Leheune, P. (2014): Towards understanding wild boar Sus scrofa movement: a synthetic movement ecology approach. 

Thurfjell, H., Spong, G.& Ericsson, G. (2014): Effects of weather, season, and daylight on female wild boar movement. Acta Theriol, 59, 467-472.