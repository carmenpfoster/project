---
<<<<<<< HEAD
title: The effects of weather on wild boar movement
subtitle: A subtle subtitle
author: Carmen Pfoster and Vibiga Vinotharajah
=======
title: The influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland
subtitle: A subtle subtitle
author: Vibiga Vinotharajah and Carmen Pfoster
>>>>>>> 4a51df9809582b19cda44f6599fd635938037ff7
output: html_document

---


<!-- You can add  your R Code with Code chunks-->

```{r, echo = FALSE, warning=FALSE, message=FALSE}

# You can set chunk options individually per code chunk, as was done with this
# code chunk.

# echo = FALSE           hides the code from the generated output
# warning = FALSE        hides warnings from the generated output
# message = FALSE        hides messages from the generated output

# To set the setting for all code chunks, use the following code:

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

install.packages("devtools")
```


## Abstract

<!-- the following is just a placeholder text, remove it!-->
Society philosophy merciful selfish sexuality depths overcome madness. Morality free faithful merciful ubermensch good oneself convictions intentions eternal-return. Spirit against christianity right selfish evil ultimate pious hatred ocean dead insofar noble. Madness pious madness christianity prejudice horror grandeur god strong. Ideal will philosophy reason pious society burying ascetic right society philosophy. Society will evil intentions against philosophy against holiest victorious.


## Introduction

Interactions between different factors can have consequences for population dynamics, species distribution and individual fitness, which are the result of animal movement decisions. Nowadays it is possible to capture spatial behaviour through modern technology such as GPS-System. On one hand, such data give insights into movement patterns on different scales and on the other hand enable a better understanding of the effects of different contexts on spatial behaviour (Morelle et al. 2014: 16).

An important factor, which affects the environmental conditions of animals and therefore the animal movement, is weather (Thurfjell et al. 2014: 467). The weather can influence the mobility, the food availability, or the energetic demands of animals. There are a few studies which analyse the effects of weather on wild boar movement (Thurjfell et al. 2014; Lemel et al. 2003; Morelle et al. 2015). 

In this project, we aim to analyse the effects of weather on wild boar movement in the year 2014. According to different studies (Thurfjell et al. 2014; Morelle et al. 2015), wild boar movement is expected to be affected by weather factors. Wild boar is an omnivorous mammal mostly ranging in border zones between pastures and forests (Lemel et al. 2003: 29). In human-dominated landscapes wild boar move less during the day than during the night (Thurfjell et al. 2014: 467). Apart from that cold weather increases the movement in the night, which means a higher demand of energy used (Lemel et al. 2003: 32). In times of snow cover, wild boars decrease their movement duration and distance (Thurfjell et al. 2014: 468). Precipitation increases the movement duration and distance (Morelle et al. 2015: 20). Different studies show that there are effects of weather on wild boar movement. Most of these studies used wild boar movement data from Sweden (Thurjfell et al. 2014; Lemel et al. 2003). Since the wild boar movement data, provided for this project, is from Switzerland, the aim of this project is to analyse the influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland. Thus, the research question for this study is: “Is there a seasonal difference in the wild boar moving pattern (clustering vs. moving but also regarding the location and properties of their habitat?”.


```{r}
library(ComputationalMovementAnalysisData)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(sf)
library(lubridate)
library(adehabitatHR)
library(adehabitatLT)
library(tmap)
library(readr)
tmap_mode("view")
# Include tables with the function "kable"

knitr::kable(head(wildschwein_BE))

#loading wildboar data
wildschwein <- wildschwein_BE
wildschwein <- st_as_sf(wildschwein,
                        coords = c("E", "N"), 
                        crs = 2056,
                        remove = FALSE)
```

<<<<<<< HEAD
## Literature Review
Since there are some studies, which already analysed the effects of weather on wild boar movement, it is important to discuss and present the main statements of them.
In 1986, Dardaillon conducted a study with wild boar from the Southern France (Dardaillon 1986). The author analysed the seasonal habitat selection and use by wild boars in relation to six habitat types (Dardaillon 1986: 251). In his study, the author discussed with his results that the estimated autumn to spring density is higher than the summer one (Dardaillon 1986: 264). In the summer season, wild boars tend to emigrate to agricultural crops because of what their movement is higher in warm season. Dardaillon does not focus on the effects of weather on wild boar, but this study shows that there are seasonal changes which influence the wild boar movement.
Morelle et al. reviewed the literature on wild boar movement ecology with a movement ecology framework. In their review they try to increase the knowledge of the drivers and mechanisms of the spatial behaviour of wild boar (Morelle et al. 2015: 16). In this study, it is stated that to find out where and when the wild boars move external factors, for example seasonality of resources, must be considered (Morelle et al. 2015: 19-20). The study discusses that wild boar can adapt to the seasonality of food resources, where the reduce their movement and home range in masting trees rich areas in autumn (Morelle et al. 2015: 20). Furthermore, Morelle and his colleagues present in a table that wild boar movement decreases at low temperatures, there is increased activity in humid air conditions and snow cover limits the wild boar movement at local and regional levels (Morelle et al. 2015: 23).
The study from Thurfjell and his colleagues (2014) discuss the effects of weather on movement of wild boars in Sweden. They used weather data, especially temperature, precipitation, and snow depth. The seasons were divided into five different seasons, where they divided summer into early and late summer (Thurfjell 2014: 468). The results from their study show that wild boar decrease their movement in precipitation during winter and at low temperatures. Wild boar increased their movement in the late summer season. Here one can see that Morelle and his colleagues’ reviews literature about weather effects on wild boar movement stated the same arguments (2015: 20). 

=======

```{r}
#assigning season to each measurement point
wildschwein <- wildschwein %>% 
  mutate(Month = format(as.Date(DatetimeUTC), "%m"))
  
wildschwein <- wildschwein %>% 
  mutate(season = ifelse(wildschwein$Month == "12" | wildschwein$Month == "01" | wildschwein$Month == "02", "winter",
                    ifelse(wildschwein$Month == "03" | wildschwein$Month == "04" | wildschwein$Month == "05", "spring",
                    ifelse(wildschwein$Month == "06" | wildschwein$Month == "07" | wildschwein$Month == "08", "summer",
                    ifelse(wildschwein$Month == "09" | wildschwein$Month == "10" | wildschwein$Month == "11", "autumn", "no")))))
```

```{r}
# plots for presentations
#ueli <- filter(wildschwein, TierID == "1")
#sabine <- filter(wildschwein, TierID == "2")
#nicole <- filter(wildschwein, TierID == "5")


#ggplot(ueli, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Ueli (ID=1)")

#ggplot(sabine, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Sabine (ID=2)")
  
#ggplot(nicole, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Nicole (ID=5)")
```

```{r}
# plots for presentations
#tm_shape(ueli)+
 # tm_dots(col="season")

#tm_shape(sabine)+
 # tm_dots(col="season")

#tm_shape(nicole)+
 # tm_dots(col="season")
```

```{r}
## Reading the weather data
weatherData <- read_delim("order_103728_data_temp.txt", delim = ";")
precipData <- read_delim("order_103873_data_precip.txt", delim = ";")
# Creating additional dataframe, based on the legend.txt for adding
# important info to our dataset

stn <- c("CRM","NEU")
stn_names <- c("Cressier","Neuchaetel")
koord_E <- c(7.067, 6.95)
koord_N <- c(47.05,47.00)
hoehe <- c(430,485) # in meters

legend <- data.frame(stn,stn_names,koord_E,koord_N,hoehe)
```


```{r}
# Joining the station and temperature dataframes
data_comb <- full_join(weatherData, legend, by="stn") %>% na.omit()
data_comb <- full_join(data_comb, precipData, by= c("stn","time")) %>% na.omit()

#removing unnecessary columns
data_comb <- subset(data_comb, select = -c(qtre200d0, mtre200d0))

# Converting to an sf object
data_sf <- st_as_sf(data_comb, coords = c("koord_E", "koord_N"))
data_sf <- data_sf %>% 
  mutate(date = ymd(time)) %>% 
  mutate(tre200d0 = as.numeric(tre200d0)) %>% 
  mutate(rka150d0 = as.numeric(rka150d0))

data_sf <- data_sf %>% 
  group_by(date) %>% 
  mutate(temp = mean(tre200d0), precip = mean(rka150d0)) %>% 
  st_drop_geometry()

temp_precip <- data_sf %>% 
  filter(stn == "CRM")
```

```{r}
wildschwein <- wildschwein %>% 
  mutate(date = as.Date(DatetimeUTC))

wildschwein <- left_join(wildschwein, temp_precip, by = "date")
wildschwein <- subset(wildschwein, select = -c(tre200d0, rka150d0))
```

```{r}
ueli <- filter(wildschwein, TierID == "1")
sabine <- filter(wildschwein, TierID == "2")
nicole <- filter(wildschwein, TierID == "5")

ggplot(ueli, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Ueli (ID=1)")

ggplot(sabine, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Sabine (ID=2)")
  
ggplot(nicole, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Nicole (ID=5)")

ggplot(ueli, aes(E,N, colour=precip)) +
  geom_point()+
  ggtitle("Movement of Ueli (ID=1)")

ggplot(sabine, aes(E,N, colour=precip)) +
  geom_point()+
  ggtitle("Movement of Sabine (ID=2)")
  
ggplot(nicole, aes(E,N, colour=precip)) +
  geom_point()+
  ggtitle("Movement of Nicole (ID=5)")
```

```{r}
#testing segmentation on ueli
ueli <- filter(wildschwein, TierID == "1")
ueli <- ueli %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),
    stepMean = rowMeans(                       
      cbind(                                   
        sqrt((lag(E,3)-E)^2+(lag(E,3)-E)^2),   
        sqrt((lag(E,2)-E)^2+(lag(E,2)-E)^2),   
        sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),   
        sqrt((E-lead(E,1))^2+(E-lead(E,1))^2),  
        sqrt((E-lead(E,2))^2+(E-lead(E,2))^2),
        sqrt((E-lead(E,3))^2+(E-lead(E,3))^2)  
        )                                        
    )
  )

summary(ueli$stepLength)

ggplot(ueli, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(ueli$stepLength,na.rm = TRUE))

ueli <- ueli %>%
  mutate(
    static = stepMean < mean(ueli$stepMean,na.rm = TRUE)
  ) 

ueli_dailysummary <- ueli %>% 
  group_by(time, season, temp, precip) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE),
            ratio = sum(static == TRUE)/(sum(static == TRUE)+ sum(static == FALSE)))
```

```{r}
ueli1 = subset(ueli, time=="20140704")
ggplot(ueli1, aes(x = E, y = N, col = static)) +
  geom_point()+geom_path()
```


```{r}
# ueli temperature daily distance
ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

#ueli temperature static vs movement
ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance)) + geom_point()+labs(title = "scatterplot ueli without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=temp, y=ratio)) + geom_point()+labs(title = "scatterplot ueli without trend")
```

```{r}
#ueli precipitation daily distance
ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=precip, y=daily_distance)) + geom_point()+labs(title = "scatterplot ueli without trend")

#ueli precipitation ratio
ggplot(ueli_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=precip, y=ratio)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=precip, y=ratio)) + geom_point()+labs(title = "scatterplot ueli without trend")
```


```{r}
# calculating steplength for every wild boar (euclidean distance between sampling points)
wildschwein_steplength <- wildschwein %>% 
  group_by(TierID) %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),
    stepMean = rowMeans(                       
      cbind(                                   
        sqrt((lag(E,3)-E)^2+(lag(E,3)-E)^2),   
        sqrt((lag(E,2)-E)^2+(lag(E,2)-E)^2),   
        sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),   
        sqrt((E-lead(E,1))^2+(E-lead(E,1))^2),  
        sqrt((E-lead(E,2))^2+(E-lead(E,2))^2),
        sqrt((E-lead(E,3))^2+(E-lead(E,3))^2)  
        )                                        
    )
  )

summary(wildschwein_steplength$stepLength)

#histogram steplength, line == mean
ggplot(wildschwein_steplength, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(wildschwein_steplength$stepLength,na.rm = TRUE))

#steplength < mean steplength --> static (to be discussed!!)
wildschwein_steplength <- wildschwein_steplength %>%
  mutate(
    static = stepMean < mean(wildschwein_steplength$stepMean,na.rm = TRUE)
  ) 

#calculating daily distance per wild boar --> Achtung: Annahme dass alle regelmässige Messungen über den gesamten Tag haben (wurde noch nicht geprüft)
wildschwein_dailysummary <- wildschwein_steplength %>% 
  group_by(TierID, time, season, temp, precip) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE),
            ratio = sum(static == TRUE)/(sum(static == TRUE)+ sum(static == FALSE)))
```

```{r}
# all wild boar temperature daily distance
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")

#all wild boar temperature ratio
ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")
```

```{r}
#all wild boar precipitation daily distance
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")

#all wild boar precipitation ratio
ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")
```


```{r}
# übersicht temperature und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```

```{r}
# übersicht precipitation und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```


```{r}
# einzelner plot pro wildschwein in gross (gleicher input wie oben mit facet_wrap)
#vielleicht sieht man so spannende Muster besser
wild_boars <- c(unique(wildschwein_dailysummary$TierID))

for (i in wild_boars){
  subs <- subset(wildschwein_dailysummary, TierID == i) %>% 
  ggplot(aes(x=temp, y=daily_distance, col=season))+geom_point()+labs(title = "TierID", subtitle = as.character(i))
  print(subs)
}
```

```{r}
#boxplot daily distance season
ggplot(wildschwein_dailysummary, aes(x = season, y = daily_distance)) + 
  geom_boxplot()
```


<!-- the following is just a placeholder text, remove it!-->
Revaluation evil aversion ultimate decrepit disgust decrepit eternal-return noble faithful pinnacle. Truth ascetic inexpedient decrepit free. Ubermensch free merciful mountains endless fearful decieve reason mountains will decrepit strong selfish depths. Overcome faith snare gains oneself transvaluation.
>>>>>>> 4a51df9809582b19cda44f6599fd635938037ff7

```{r}
# include plots automatically

ggplot(schreck_locations, aes(E, N)) +
  geom_point() +
  coord_map()

```





## Material and Methods

<!-- the following is just a placeholder text, remove it!-->
Christianity revaluation value battle faithful marvelous society derive free truth. Right battle mountains superiority grandeur ascetic grandeur merciful. Derive against intentions burying salvation ocean. Right intentions dead victorious ideal spirit evil ultimate joy. Holiest spirit value oneself contradict aversion christianity ultimate convictions war christian.

## Results

<!-- the following is just a placeholder text, remove it!-->
Philosophy oneself passion play fearful self noble zarathustra deceptions sexuality. Endless ocean of oneself dead ocean. Selfish decrepit.

## Discussion

<!-- the following is just a placeholder text, remove it!-->
Justice convictions spirit sexuality insofar free marvelous joy. Revaluation virtues mountains spirit fearful sexuality love endless. Society intentions will noble burying aversion moral. Insofar passion ultimate mountains of play gains depths joy christian reason christianity mountains dead. Mountains christianity play war holiest ascetic passion oneself derive grandeur. Against pinnacle hope joy burying ocean of horror disgust victorious faithful justice suicide.

## References
Dardaillon, M. (1986): Seasonal Variations in Habitat Selection and Spatial Distribution of Wild Boar (Sus Scrofa) in the Camargue, Southern France. Behavioural Processes, 13, 251-268.

Lemel, J., Truve, J.& Soderberg, B. (2003): Variation in ranging and activity behaviour of European wild boar Sus scrofa in Sweden. Wildl Biol 9, 29–36.Mammal Review, 45, 15-29.

Morelle, K. Podgroski, T., Prévot, C., Keuling, O., Lehaire, F. & Leheune, P. (2014): Towards understanding wild boar Sus scrofa movement: a synthetic movement ecology approach. 

Thurfjell, H., Spong, G.& Ericsson, G. (2014): Effects of weather, season, and daylight on female wild boar movement. Acta Theriol, 59, 467-472.