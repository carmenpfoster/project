---
title: The influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland
subtitle: A subtle subtitle
author: Vibiga Vinotharajah and Carmen Pfoster
output: html_document

---


<!-- You can add  your R Code with Code chunks-->

```{r, echo = FALSE, warning=FALSE, message=FALSE}

# You can set chunk options individually per code chunk, as was done with this
# code chunk.

# echo = FALSE           hides the code from the generated output
# warning = FALSE        hides warnings from the generated output
# message = FALSE        hides messages from the generated output

# To set the setting for all code chunks, use the following code:

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)

```


## Abstract

<!-- the following is just a placeholder text, remove it!-->
Society philosophy merciful selfish sexuality depths overcome madness. Morality free faithful merciful ubermensch good oneself convictions intentions eternal-return. Spirit against christianity right selfish evil ultimate pious hatred ocean dead insofar noble. Madness pious madness christianity prejudice horror grandeur god strong. Ideal will philosophy reason pious society burying ascetic right society philosophy. Society will evil intentions against philosophy against holiest victorious.


## Introduction

<!-- the following is just a placeholder text, remove it!-->
Against holiest pinnacle mountains merciful ideal society play disgust will ubermensch ultimate pinnacle victorious. Snare value law gains battle pious intentions revaluation strong. Insofar snare faith ideal oneself.

```{r}
library(ComputationalMovementAnalysisData)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(sf)
library(lubridate)
library(adehabitatHR)
library(adehabitatLT)
library(tmap)
library(readr)
tmap_mode("view")
# Include tables with the function "kable"

knitr::kable(head(wildschwein_BE))

#loading wildboar data
wildschwein <- wildschwein_BE
wildschwein <- st_as_sf(wildschwein,
                        coords = c("E", "N"), 
                        crs = 2056,
                        remove = FALSE)
```


```{r}
#assigning season to each measurement point
wildschwein <- wildschwein %>% 
  mutate(Month = format(as.Date(DatetimeUTC), "%m"))
  
wildschwein <- wildschwein %>% 
  mutate(season = ifelse(wildschwein$Month == "12" | wildschwein$Month == "01" | wildschwein$Month == "02", "winter",
                    ifelse(wildschwein$Month == "03" | wildschwein$Month == "04" | wildschwein$Month == "05", "spring",
                    ifelse(wildschwein$Month == "06" | wildschwein$Month == "07" | wildschwein$Month == "08", "summer",
                    ifelse(wildschwein$Month == "09" | wildschwein$Month == "10" | wildschwein$Month == "11", "autumn", "no")))))
```

```{r}
# plots for presentations
#ueli <- filter(wildschwein, TierID == "1")
#sabine <- filter(wildschwein, TierID == "2")
#nicole <- filter(wildschwein, TierID == "5")


#ggplot(ueli, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Ueli (ID=1)")

#ggplot(sabine, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Sabine (ID=2)")
  
#ggplot(nicole, aes(E,N, colour=season)) +
  #geom_point()+
  #ggtitle("Movement of Nicole (ID=5)")
```

```{r}
# plots for presentations
#tm_shape(ueli)+
 # tm_dots(col="season")

#tm_shape(sabine)+
 # tm_dots(col="season")

#tm_shape(nicole)+
 # tm_dots(col="season")
```

```{r}
## Reading the weather data
weatherData <- read_delim("order_103728_data.txt", delim = ";")

# Creating additional dataframe, based on the legend.txt for adding
# important info to our dataset

stn <- c("CRM","NEU")
stn_names <- c("Cressier","Neuchaetel")
koord_E <- c(7.067, 6.95)
koord_N <- c(47.05,47.00)
hoehe <- c(430,485) # in meters

legend <- data.frame(stn,stn_names,koord_E,koord_N,hoehe)
```


```{r}
# Joining the two dataframes
data_comb <- full_join(weatherData, legend, by="stn") %>% na.omit()

# Converting to an sf object
data_sf <- st_as_sf(data_comb, coords = c("koord_E", "koord_N"))
data_sf <- data_sf %>% 
  mutate(date = ymd(time)) %>% 
  mutate(tre200d0 = as.numeric(tre200d0))

data_sf <- data_sf %>% 
  group_by(date) %>% 
  mutate(temp = mean(tre200d0)) %>% 
  st_drop_geometry()

cressier <- data_sf %>% 
  filter(stn == "CRM")
```

```{r}
wildschwein <- wildschwein %>% 
  mutate(date = as.Date(DatetimeUTC))

wildschwein <- left_join(wildschwein, cressier, by = "date")
```

```{r}
ueli <- filter(wildschwein, TierID == "1")
sabine <- filter(wildschwein, TierID == "2")
nicole <- filter(wildschwein, TierID == "5")

ggplot(ueli, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Ueli (ID=1)")

ggplot(sabine, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Sabine (ID=2)")
  
ggplot(nicole, aes(E,N, colour=temp)) +
  geom_point()+
  ggtitle("Movement of Nicole (ID=5)")
```

```{r}
#testing segmentation on ueli
ueli <- filter(wildschwein, TierID == "1")
ueli <- ueli %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2))

summary(ueli$stepLength)

ggplot(ueli, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(ueli$stepLength,na.rm = TRUE))

ueli <- ueli %>%
  mutate(
    static = stepLength < mean(ueli$stepLength,na.rm = TRUE)
  ) 

ueli_dailysummary <- ueli %>% 
  group_by(time, season, temp) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE))


```

```{r}
ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with trend per season")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point()+labs(title = "scatterplot ueli per season without trend")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance)) + geom_point()+geom_smooth(method=lm)+labs(title = "scatterplot ueli with overall trend")

ggplot(ueli_dailysummary, aes(x=temp, y=daily_distance)) + geom_point()+labs(title = "scatterplot ueli without trend")
```


```{r}
# calculating steplength for every wild boar (euclidean distance between sampling points)
wildschwein_steplength <- wildschwein %>% 
  group_by(TierID) %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2))

summary(wildschwein_steplength$stepLength)

#histogram steplength, line == mean
ggplot(wildschwein_steplength, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(wildschwein_steplength$stepLength,na.rm = TRUE))

#steplength < mean steplength --> static (to be discussed!!)
wildschwein_steplength <- wildschwein_steplength %>%
  mutate(
    static = stepLength < mean(wildschwein_steplength$stepLength,na.rm = TRUE)
  ) 

#calculating daily distance per wild boar --> Achtung: Annahme dass alle regelmässige Messungen über den gesamten Tag haben (wurde noch nicht geprüft)
wildschwein_dailysummary <- wildschwein_steplength %>% 
  group_by(TierID, time, season, temp) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE))
```

```{r}
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.8)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with trend per season")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars per season without trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance)) + geom_point(size=0.9)+geom_smooth(method=lm)+labs(title = "scatterplot all wildboars with overall trend")

ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance)) + geom_point(size=0.9)+labs(title = "scatterplot all wildboars without trend")
```

```{r}
# übersicht temperature und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) +
  geom_point()+
  facet_wrap(~TierID,labeller = label_both)
```


```{r}
# einzelner plot pro wildschwein in gross (gleicher input wie oben mit facet_wrap)
#vielleicht sieht man so spannende Muster besser
wild_boars <- c(unique(wildschwein_dailysummary$TierID))

for (i in wild_boars){
  subs <- subset(wildschwein_dailysummary, TierID == i) %>% 
  ggplot(aes(x=temp, y=daily_distance, col=season))+geom_point()+labs(title = "TierID", subtitle = as.character(i))
  print(subs)
}
```


<!-- the following is just a placeholder text, remove it!-->
Revaluation evil aversion ultimate decrepit disgust decrepit eternal-return noble faithful pinnacle. Truth ascetic inexpedient decrepit free. Ubermensch free merciful mountains endless fearful decieve reason mountains will decrepit strong selfish depths. Overcome faith snare gains oneself transvaluation.

```{r}
# include plots automatically

ggplot(schreck_locations, aes(E, N)) +
  geom_point() +
  coord_map()

```





## Material and Methods

<!-- the following is just a placeholder text, remove it!-->
Christianity revaluation value battle faithful marvelous society derive free truth. Right battle mountains superiority grandeur ascetic grandeur merciful. Derive against intentions burying salvation ocean. Right intentions dead victorious ideal spirit evil ultimate joy. Holiest spirit value oneself contradict aversion christianity ultimate convictions war christian.

## Results

<!-- the following is just a placeholder text, remove it!-->
Philosophy oneself passion play fearful self noble zarathustra deceptions sexuality. Endless ocean of oneself dead ocean. Selfish decrepit.

## Discussion

<!-- the following is just a placeholder text, remove it!-->
Justice convictions spirit sexuality insofar free marvelous joy. Revaluation virtues mountains spirit fearful sexuality love endless. Society intentions will noble burying aversion moral. Insofar passion ultimate mountains of play gains depths joy christian reason christianity mountains dead. Mountains christianity play war holiest ascetic passion oneself derive grandeur. Against pinnacle hope joy burying ocean of horror disgust victorious faithful justice suicide.

