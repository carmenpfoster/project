---
title: The influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland
subtitle: GEO880 Computational Movement Analysis - Semester Project
author: Vibiga Vinotharajah and Carmen Pfoster
output: 
  html_document:
    toc: true
    toc_float: true
---


## Abstract

An important factor, which affects environmental conditions of animals, is weather. A few studies show that wild boar decrease their movement at low temperatures and increase their movement in late summer. By studying wild boar movement, we analysed the influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland. The wild boars increase their movement at higher temperatures and during summer precipitation and decrease their movement at low temperatures. There is also a seasonal difference regarding the clustered and not clustered moving pattern. In addition, the use of location/habitat differs with the influence of temperature and is dependent on individual wild boars. With our research, we confirm previous studies that weather conditions indeed play a role in the wild boar movement.


## Introduction

Interactions between different factors can have consequences for population dynamics, species distribution and individual fitness, which are the result of animal movement decisions. Nowadays, it is possible to capture spatial behaviour through modern technology such as GPS-System. On one hand, such data give insights into movement patterns on different scales and on the other hand enables a better understanding of the effects of different contexts on spatial behaviour (Morelle et al. 2014: 16). The weather can influence the mobility, the food availability, or the energetic demands of animals. There are a few studies which analyse the effects of weather on wild boar movement (Thurjfell et al. 2014; Lemel et al. 2003; Morelle et al. 2015). 
In this project, we aim to analyse the effects of weather on wild boar movement in the years 2014 to 2016. According to different studies (Thurfjell et al. 2014; Morelle et al. 2015), wild boar movement is expected to be affected by weather factors. Wild boar is an omnivorous mammal mostly ranging in border zones between pastures and forests (Lemel et al. 2003: 29). In human-dominated landscapes wild boars move less during the day than during the night (Thurfjell et al. 2014: 467). Apart from that, cold weather increases the movement in the night, which means a higher demand of energy used (Lemel et al. 2003: 32). In times of snow cover, wild boars decrease their movement duration and distance (Thurfjell et al. 2014: 468). Precipitation increases the movement duration and distance (Morelle et al. 2015: 20). Different studies show that there are effects of weather on wild boar movement. Most of these studies used wild boar movement data from Sweden (Thurfjell et al. 2014; Lemel et al. 2003). Since the wild boar movement data, provided for this project, is from Switzerland, the aim of this project is to analyse the influence of temperature and precipitation on the movement and use of habitat of wild boar in Switzerland. Thus, the research question for this study is: “Is there a seasonal difference in the wild boar moving pattern (clustering vs. moving) but also regarding the location of their habitat?”.



```{r loading-packages, echo = FALSE, warning = FALSE, message = FALSE}
library(ComputationalMovementAnalysisData)
library(ggplot2)
library(dplyr)
library(tidyverse)
library(sf)
library(lubridate)
library(tmap)
library(readr)
tmap_mode("view")

knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


## Literature Review
Since there are some studies, which already analysed the effects of weather on wild boar movement, it is important to discuss and present the main statements of them.
In 1986, Dardaillon conducted a study with wild boar from the Southern France (Dardaillon 1986). The author analysed the seasonal habitat selection and use by wild boars in relation to six habitat types (Dardaillon 1986: 251). In his study, the author discussed with his results that the estimated autumn to spring density is higher than the summer one (Dardaillon 1986: 264). In the summer season, wild boars tend to emigrate to agricultural crops because of what their movement is higher in warm season. Dardaillon does not focus on the effects of weather on wild boar, but this study shows that there are seasonal changes which influence the wild boar movement.
Morelle et al. reviewed the literature on wild boar movement ecology with a movement ecology framework. In their review they try to increase the knowledge of the drivers and mechanisms of the spatial behaviour of wild boar (Morelle et al. 2015: 16). In this study, it is stated that to find out where and when the wild boars move external factors, for example seasonality of resources, must be considered (Morelle et al. 2015: 19-20). The study discusses that wild boar can adapt to the seasonality of food resources, where the reduce their movement and home range in masting trees rich areas in autumn (Morelle et al. 2015: 20). Furthermore, Morelle and his colleagues present in a table that wild boar movement decreases at low temperatures, there is increased activity in humid air conditions and snow cover limits the wild boar movement at local and regional levels (Morelle et al. 2015: 23).
The study from Thurfjell and his colleagues (2014) discuss the effects of weather on movement of wild boars in Sweden. They used weather data, especially temperature, precipitation, and snow depth. The seasons were divided into five different seasons, where they divided summer into early and late summer (Thurfjell 2014: 468). The results from their study show that wild boar decrease their movement in precipitation during winter and at low temperatures. Wild boar increased their movement in the late summer season. Here one can see that Morelle and his colleagues’ reviews literature about weather effects on wild boar movement stated the same arguments (2015: 20). 

## Material and Methods

As already mentioned, the aim of this study is to analyse the effects of weather and season on the movement and habitat of wild boar in Switzerland. For the analysis a wild boar data set provided by the ZHAW is used. Between May 2014 and October 2016 18 different wild boars were tracked with GPS collars in the area between Lake Neuchâtel and Lake Biel. Generally, the location was recorded in 15-minutes-intervals. In addition to the time stamp and the coordinates, the moonillumination was indicated for every measurement as well but this information was not used in this study. The used information of the dataset can be seen below in Table 1. 

``` {r loading-wildboar-data}
#loading wildboar data
wildschwein <- wildschwein_BE
wildschwein <- st_as_sf(wildschwein,
                        coords = c("E", "N"), 
                        crs = 2056,
                        remove = FALSE)

#drop unnecessary columns
wildschwein <- subset(wildschwein, select = -c(CollarID, day, moonilumination))

# Include tables with the function "kable"
knitr::kable(head(wildschwein))
```

Table 1: Overview of the used wild boar data structure



As the goal of this research is to analyze the influence of weather and season on the movement patterns of wild boar the following additional data was used:
- Mean daily temperature [°C] of two weather stations (Neuchâtel and Cressier)
- Daily precipitation [mm] of the same two weather stations
Both datasets were accessed via the IDAweb portal of the Federal Office of Meteorology and Climatology MeteoSwiss.

On Figure 1 below one can see the whole study area and when zooming out, the two locations of the weather stations are visible as well.

```{r loading-weather-data}
# Reading the weather data
weatherData <- read_delim("order_103728_data_temp.txt", delim = ";")
precipData <- read_delim("order_103873_data_precip.txt", delim = ";")
# Creating additional dataframe, based on the legend.txt for adding
# important info to our dataset

stn <- c("CRM","NEU")
stn_names <- c("Cressier","Neuchâtel")
koord_E <- c(7.067, 6.95)
koord_N <- c(47.05,47.00)
hoehe <- c(430,485) # in meters

legend <- data.frame(stn,stn_names,koord_E,koord_N,hoehe)
```

```{r join-station-and-weather-data}
# Joining the station and temperature dataframes
data_comb <- full_join(weatherData, legend, by="stn") %>% na.omit()
data_comb <- full_join(data_comb, precipData, by= c("stn","time")) %>% na.omit()

#removing unnecessary columns
data_comb <- subset(data_comb, select = -c(qtre200d0, mtre200d0))

# Converting to an sf object
data_sf <- st_as_sf(data_comb, coords = c("koord_E", "koord_N"), crs = 4326)
data_sf <- data_sf %>% 
  mutate(date = ymd(time)) %>% 
  mutate(tre200d0 = as.numeric(tre200d0)) %>% 
  mutate(rka150d0 = as.numeric(rka150d0))

data_sf_lv95 <- st_transform(data_sf, 2056)

map_stations <- data_sf_lv95 %>% 
  group_by(stn_names) %>% 
  summarise()
```

```{r spatial-overview}
#Figure 1
wildschwein_smry <- summarise(wildschwein)

wildschwein_convex <- st_convex_hull(wildschwein_smry)

tm_shape(wildschwein_convex)+
  tm_polygons(col="green", alpha = 0.25, group='convex hull')+
  tm_shape(map_stations)+
  tm_dots(col="red", group='Weather station')
```

Figure 1: Overview of the study area (used weather stations and convex polygon of all wildboar data points)



Due to the fact that all the before mentioned studies used slightly different classifications for the seasons and difference between climatological differences between Sweden and Switzerland the measurements of this study were categorized into a different season classification.  For reasons of simplicity, the wild boar data was classified into the meteorological seasons, which always classifies the whole months into one season:

| Winter        | December, January, February     |
| Spring        | March, April, May               |
| Summer        | June, July, August              |
| Autumn        | September, October, November    |


```{r assigning-season}
#assigning season to each measurement point
wildschwein <- wildschwein %>% 
  mutate(Month = format(as.Date(DatetimeUTC), "%m"))
  
wildschwein <- wildschwein %>% 
  mutate(season = ifelse(wildschwein$Month == "12" | wildschwein$Month == "01" | wildschwein$Month == "02", "winter",
                    ifelse(wildschwein$Month == "03" | wildschwein$Month == "04" | wildschwein$Month == "05", "spring",
                    ifelse(wildschwein$Month == "06" | wildschwein$Month == "07" | wildschwein$Month == "08", "summer",
                    ifelse(wildschwein$Month == "09" | wildschwein$Month == "10" | wildschwein$Month == "11", "autumn", "no")))))
```


On the weather data some pre-processing was required too. To consider both meteo stations, the mean temperature and precipitation of the two measurements was calculated for every day. After that the weather data frame was joined to the wild boar data frame.

```{r join-weather-and-wild-boar-data}
data_sf_lv95 <- data_sf_lv95 %>% 
  group_by(date) %>% 
  mutate(temp = mean(tre200d0), precip = mean(rka150d0)) %>% 
  st_drop_geometry()

temp_precip <- data_sf_lv95 %>% 
  filter(stn == "CRM")

wildschwein <- wildschwein %>% 
  mutate(date = as.Date(DatetimeUTC))

wildschwein <- left_join(wildschwein, temp_precip, by = "date")
wildschwein <- subset(wildschwein, select = -c(tre200d0, rka150d0))
```

### Conceptualization of movement
To analyse the wild boar moving patterns two different approaches were implemented:

- To get an indicator for the total daily movement, the euclidean distance along all tracking locations per day was calculated for every individual wild boar. Then the total daily distance covered could be opposed to the temperature and precipitation as well as the seasons.

- For the analysis of the amount of clustering that happened per day, the trajectories were segmented, similarly to the segmentation in Exercise 3. For every point the distance to the six preceding and following points were calculated. The mean of these 12 distances can be seen as the mean step length. Then all mean step lengths were classified as static when they are below the mean step length of all mean step lengths. Finally, the ratio of static points of all points was calculated. This was then again opposed to the temperature and precipitation data and the season classification like the before described daily movement.


```{r calculating-steplength-and-stepmean}
# calculating steplength for every wild boar (euclidean distance between sampling points)
wildschwein_steplength <- wildschwein %>% 
  group_by(TierName) %>% 
  mutate(
    stepLength = sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),
    stepMean = rowMeans(                       
      cbind(                                   
        sqrt((lag(E,6)-E)^2+(lag(E,6)-E)^2),
        sqrt((lag(E,5)-E)^2+(lag(E,5)-E)^2),
        sqrt((lag(E,4)-E)^2+(lag(E,4)-E)^2),
        sqrt((lag(E,3)-E)^2+(lag(E,3)-E)^2),   
        sqrt((lag(E,2)-E)^2+(lag(E,2)-E)^2),   
        sqrt((lag(E,1)-E)^2+(lag(E,1)-E)^2),   
        sqrt((E-lead(E,1))^2+(E-lead(E,1))^2),  
        sqrt((E-lead(E,2))^2+(E-lead(E,2))^2),
        sqrt((E-lead(E,3))^2+(E-lead(E,3))^2),
        sqrt((E-lead(E,4))^2+(E-lead(E,4))^2),
        sqrt((E-lead(E,5))^2+(E-lead(E,5))^2),
        sqrt((E-lead(E,6))^2+(E-lead(E,6))^2)
        )                                        
    )
  )

#histogram steplength, line == mean
ggplot(wildschwein_steplength, aes(stepLength)) +
  geom_histogram(binwidth = 1) +
  geom_vline(xintercept = mean(wildschwein_steplength$stepLength,na.rm = TRUE))+
  ggtitle("Histogram of all mean steplength")+
  theme(plot.caption = element_text(hjust = 0)) +
  labs(caption = "Figure 2: mean steplength for every step and total mean steplength")+
  xlab("Steplength [m]")

#steplength < mean steplength --> static (to be discussed!!)
wildschwein_steplength <- wildschwein_steplength %>%
  mutate(
    static = stepMean < mean(wildschwein_steplength$stepMean,na.rm = TRUE)
  ) 

#calculating daily distance per wild boar --> Achtung: Annahme dass alle regelmässige Messungen über den gesamten Tag haben (wurde noch nicht geprüft)
wildschwein_dailysummary <- wildschwein_steplength %>% 
  group_by(TierName, time, season, temp, precip) %>% 
  summarise(daily_distance = sum(stepLength, na.rm = TRUE),
            ratio = sum(static == TRUE)/(sum(static == TRUE)+ sum(static == FALSE)))
```

### Conceptualization of location and properties of the habitat 
In a second part, the influence of the weather and the seasons is analysed in a more spatial point of view. As there are a lot of variables to consider; besides the land cover (representing the characteristics of the habitat), temperature and precipitation data is used as well as seasonal effects that probably influence the behavior of the wild boars it was decided to analyse spatial patterns in the data only in a qualitative way. Initially the three wild boar with the most sampling points were should be selected for the analysis. Due to loading and knitting issues caused by the large data set it was decided to only analyse one wild boar instead of three.

```{r number-of-measurements}
# determining animal with most measurements
wildschwein_count <- wildschwein_steplength %>%
  st_drop_geometry() %>% 
  group_by(TierName) %>% 
  summarise(n_of_measurements = n())

knitr::kable(wildschwein_count)
```

Table 2: Number of tracking points per wild boar



```{r plot-number-of-measurements}
ggplot(wildschwein_count, aes(x=TierName, y=n_of_measurements)) +
  geom_bar(stat="identity")+
  ggtitle("Overview of measurements per wild boar")+
  ylab("# of measurements")+
  theme(plot.caption = element_text(hjust = 0)) +
  labs(caption = "Figure 3: Number of tracked locations per wild boar")
```


As it can be seen in Figure 3 the wild boar with the most measurements is Caroline. The locations of that wild boar were then plotted in a map with the Swiss orthofoto as the basemap. Then the points were classified depending on the season, temperature, precipitation or the ratio of static points and searched qualitatively for interesting patterns.

```{r caroline}
#analysing habitat for the wild boar with the most measurement points
caroline <- filter(wildschwein_steplength, TierName == "Caroline")
```


## Results
Firstly, we wanted to find out how many measurement days per season and per wild boar were recorded (Figure 4). One can see that the wild boar Caroline has the most measurements over all seasons compared to the other wild boars. Some wild boars do not even have measurements for some seasons, such as Isabelle who was only tracked days for the seasons autumn and winter. This will be of importance for the discussion of the findings.

```{r number-of-measurements-per-animal}
#plot #measurement days per season
ggplot(wildschwein_dailysummary, aes(x = season))+
  geom_bar()+
  facet_wrap(~TierName, labeller = label_value)+
  labs(title = "Number of measurement days per season", subtitle = "per wild boar", caption = " Figure 4: Barplots with # of measurement days per wild boar split in the 4 seasons")+
  ylab("# of tracked days")+
  theme(plot.caption = element_text(hjust = 0))
```



```{r boxplot-distance-per-season}
#boxplot daily distance season
ggplot(wildschwein_dailysummary, aes(x = season, y = daily_distance)) + 
  geom_boxplot()+
  labs(title = "Distance travelled per day", subtitle = "per wild boar", caption = " Figure 5: Boxplot of calculated distances per day and wild boar split up in the seasons")+
  ylab("distance [m]")+
  theme(plot.caption = element_text(hjust = 0))
```

This boxplot (Figure 5) represents the daily distance, of how far the wild boars moved, in each season without including the temperature. One can see that the daily distance is further in autumn and summer compared to winter especially. The visual assumption was then tested statistically:


```{r difference-of-distance-per-season}
#statistical test for season - daily distance
model_dist <- lm(daily_distance~season, data = wildschwein_dailysummary)

par(mfrow = c(1,3))
hist(rstandard(model_dist))
hist(residuals(model_dist))
qqnorm(rstandard(model_dist))
qqline(rstandard(model_dist))
shapiro.test(rstandard(model_dist))
```

Figure 6: Statistical plots for normal distribution of the distance per season



```{r kruskal-distance-season}
kruskal.test(wildschwein_dailysummary$daily_distance~wildschwein_dailysummary$season)

pairwise.wilcox.test(wildschwein_dailysummary$daily_distance, wildschwein_dailysummary$season, p.adjust="bonferroni")
```

As there was no normal distribution in the data, the Kruskal-Wallis test was used instead of a ANOVA to test for differences in travelled distance per season. According to the test there is a significant difference between the seasons and the pair-wise analysis showed that there is a significant difference between all seasons except between summer and autumn, where the difference is not statistically significant. 



```{r boxplot-movement-ratio-per-season}
#boxplot movement ratio and seasons
ggplot(wildschwein_dailysummary, aes(x=season, y = ratio))+
  geom_boxplot()+
  labs(title = "Share of static measurement points per day", subtitle = "per wild boar", caption = "Figure 7: Boxplot of the ratio of static measurements per wild boar and day split up into the 4 seasons")+
  ylab("ratio")+
  theme(plot.caption = element_text(hjust = 0))
```

Similarly to the travelled daily distance the ratio of the static point on all tracking points per day were analysed. This boxplot (Figure 7) shows the ratios from each season. If the ratio is closer to 1 then there is more clustering in the movement per day than when the ratio is closer to 0. Autumn and winter have the same ratio, but it is important to highlight that in winter the variance is bigger than in the other seasons. The reason for that might be the small data availability for the winter. The season with the most clustering is spring. 


```{r difference-of-ratio-per-season}
#statistical difference season - ratio
model_ratio <- lm(ratio~season, data = wildschwein_dailysummary)

par(mfrow = c(1,3))
hist(rstandard(model_ratio))
hist(residuals(model_ratio))
qqnorm(rstandard(model_ratio))
qqline(rstandard(model_ratio))
shapiro.test(rstandard(model_ratio))
```

Figure 8: Statistical plots for normal distribution of the "static ratio" per season



```{r kruskal-ratio-season}
kruskal.test(wildschwein_dailysummary$ratio~wildschwein_dailysummary$season)

pairwise.wilcox.test(wildschwein_dailysummary$ratio, wildschwein_dailysummary$season, p.adjust="bonferroni")
```

Again the data was not normally distributed but the test showed that there is statistical difference between spring - autumn, spring-summer and winter-spring, which confirms the observations of the Boxplot earlier.


```{r temperature-distance}
# all wild boar temperature daily distance
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) + 
  geom_point(size=0.9)+
  geom_smooth(method=lm)+
  labs(title = "Influence of temperature on the travelled distance per day", subtitle = "per season", caption = "Figure 9: Scatterplot of mean temperature and travelled distance")+
  xlab("temperature [°C]")+
  ylab("distance [m]")+
  theme(plot.caption = element_text(hjust = 0))
```

In this plot one can see the difference between the distance per seasons depending on the temperature. Generally one can see that except for the spring, the daily travelled distance increases with rising temperatures. In the spring, the movement is rather constant. When comparing the trend lines, it can be observed that the temperature has the highest influence on the daily travelled distance in winter with a steeper slope. The slope of the summer and autumn seem to be rather similar, with a sligthly higher distance in autumn than in summer.


```{r regression-distance-temperature}
#linear regression daily distance and temperature
model_temp <- lm(daily_distance ~ temp, data=wildschwein_dailysummary)
summary(model_temp)
```

```{r regression-heteroscedasticity-temperature}
#testen für Heteroskedastizität
par(mfrow = c(1,2))
plot(model_temp, 1)
plot(fitted.values(model_temp), rstandard(model_temp))
```

Figure 10: statistical plots for heteroscedasticity of the linear regression (distance~temperature) 


The statistical analysis supports the visual analysis, at least partially. As the statistical output shows that the regression is statistically significant, the r-squared value is rather low (less then 10% of the variance can be explained by the model). So this means that the temperature generally does influence the movement of the wild boars but there is a lot of unexplained variance in the data. 



```{r temperature-ratio}
#all wild boar temperature ratio
ggplot(wildschwein_dailysummary, aes(x=temp, y=ratio, col = season)) +
  geom_point(size=0.8)+
  geom_smooth(method=lm)+
  labs(title = "Influence of temperature on the share of static measurement points", subtitle = "per season", caption = "Figure 11: Scatterplot of the mean temperature and the ratio of static measurements")+
  xlab("temperature [°C]")+
  ylab("static ratio")+
  theme(plot.caption = element_text(hjust = 0))
```

In this plot the influence of temperature on the share of static measurement points is represented. Here the analysis seems to be a bit more complex than with the distance. There are a lot of data points at a ratio of 0 or 1 which means that all tracking points of that day were either classified as static (1) or moving (0). Most points are located between a ratio of 0.5 and 1. Considering the trend lines indicate that in autumn and winter the share of clustering behavior is increasing with higher temperature. In summer the ratio is rather constant with temperature and in spring it is decreasing with increasing temperatures. But again the dispersion of the data points is rather high.


```{r travelled-distance-temperature-plot-all}
# übersicht temperature und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=temp, y=daily_distance, col = season)) +
  geom_point()+
  labs(title = "Influence of temperature on the travelled distance per day", subtitle = "per season for all wild boars seperately", caption = "Figure 12: Scatterplot of mean temperature and travelled distance for every wild boar seperately")+
  xlab("temperature [°C]")+
  ylab("distance [m]")+
  theme(plot.caption = element_text(hjust = 0))+
  facet_wrap(~TierName,labeller = label_value)
```

In Figure 12 for each wild boar a plot is created which represents the influence of temperature on the travelled distance throughout the year. It is categorized in seasons. Some wild boars have no data points in some seasons. For example, "Claude" has only data points in spring. On the other hand, one can see how the movement from each wild boar differs. "Caroline" moves a lot in almost every season, whereas "Rosa" moves a lot in spring compared to the other seasons. 


```{r precipitation-distance}
#all wild boar precipitation daily distance
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) + 
  geom_point(size=0.9)+geom_smooth(method=lm)+
  labs(title = "Influence of precipitation on the travelled distance per day", subtitle = "per season", caption = "Figure 13: Scatterplot of daily precipitation and travelled distance")+
  xlab("precipitation [mm]")+
  ylab("distance [m]")+
  theme(plot.caption = element_text(hjust = 0))
```

Now the same analysis is made for precipitation instead of temperature. In this plot the daily distance is analysed in connection to precipitation. The precipitation data includes lots of days with no precipitation, which also affects the trend lines of the seasons. However, one can see that the movement from wild boars is higher in autumn precipitation. With higher precipitation the movement in winter increases whereas in summer it decreases. One has to consider that the uncertainty is increasing with precipitation as there is only little data available with a lot of precipitation.


```{r regression-distance-precipitation}
#lineare regression distanz niederschlag
model_precip <- lm(daily_distance ~ precip, data=wildschwein_dailysummary)
summary(model_precip)
```

```{r egression-heteroscedasticity-precipitation}
#testen für Heteroskedastizität
par(mfrow = c(1,2))
plot(model_precip, 1)
plot(fitted.values(model_precip), rstandard(model_precip))
```

Figure 14: statistical plots for heteroscedasticity of the linear regression (distance~precipitation)



Again a linear regression was fitted into the precipitation data. There is a slight linear relationship but compared to the regression with temperature and daily distance this model here can even explain less of the variance with a r-squared of 0,001458. 



```{r precipitation-static}
#all wild boar precipitation ratio
ggplot(wildschwein_dailysummary, aes(x=precip, y=ratio, col = season)) +
  geom_point(size=0.8)+
  geom_smooth(method=lm)+
  labs(title = "Influence of precipitation on the share of static measurement points", subtitle = "per season", caption = "Figure 15: Scatterplot of daily precipitation and the ratio of static measurement points per wild boar")+
  xlab("precipitation [mm]")+
  ylab("static ratio")+
  theme(plot.caption = element_text(hjust = 0))
```

As already seen in Figure 11, it is difficult to see interesting patterns in the static ratio, but in combination with precipitation it is even harder. Most of the points are distributed randomly and around 0 precipitation and a few outliers influence the trend lines a lot. The uncertainty of the trend from each season is big, especially for autumn.


```{r travelled-distance-precipitation-plot-all}
# übersicht precipitation und pro tag zurückgelegte distanz für jedes einzelne wildschwein
ggplot(wildschwein_dailysummary, aes(x=precip, y=daily_distance, col = season)) +
  geom_point()+
  labs(title = "Influence of precipitation on the travelled distance per day", subtitle = "per season for all wild boars seperately", caption = "Figure 16: Scatterplot of precipitation and travelled distance for every wild boar seperately")+
  xlab("precipitation [mm]")+
  ylab("distance [m]")+
  theme(plot.caption = element_text(hjust = 0))+
  facet_wrap(~TierName,labeller = label_value)
```

Here the influence of precipitation on the travelled distance for each wild boar is represented individually. The most data points in each plot are distributed around 0 precipitation. Some wild boars move more in summer and spring precipitation, whereas other wild boars only move in certain seasonal precipitation. For example, "Ueli" has more movement in summer and spring precipitation than in other seasonal precipitation. Summarizing all the plots, one can see that most of the wild boar movement happen in summer and autumn precipitation. The movement in winter precipitation is mostly the lowest.


Finally, for the analysis of the habitat during different weather conditions or seasons, the movement through the whole year from the wild boar "Caroline" was extracted and showed in the following maps. It is split into three maps: season, temperature, and precipitation.
```{r caroline-season}
#individual analysis season
tm_shape(caroline) +
  tm_dots(col = "season")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```

Figure 17: map of the tracked locations of Caroline split into the seasons


In this map, where the seasons are represented, the wild boar Caroline mostly moves around the same habitats and places. In summer she shows a lot of spatial movement as she spends a lot of time in the forest by the lake but also in the fields a bit further away. In autumn then she mostly stays in the forest and only very few points are tracked outside that habitat. In winter Caroline moves mostly near the lake, where there are mainly some agricultural fields but also a forest (a different forest than she spends most of her time in summer and autumn). In spring she moves around the fields and also tends to spend more time in the same forest than during summer and autumn. Therefore, one can say that Caroline uses the habitats forest, which is near the lake, and the fields throughout the year and the seasonal difference between winter and summer is clear, whereas the difference between the other seasons are not that obvious.

```{r caroline-temperature}
#individual analysis temperature
tm_shape(caroline) +
  tm_dots(col = "temp", title="Temperature [°C]")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```

Figure 18: map of the tracked locations of Caroline classified with temperature


This map with the temperatures represented, mostly matches with the seasonal difference, which were shown in the map above. Caroline uses the habitats forest in high and low temperatures, whereas in low temperatures the area near the lake is used as well. Thus, the temperature and the seasonal difference coincide in the wild boar movement from Caroline.

```{r caroline-precipitation}
#individual analysis precipitation
tm_shape(caroline) +
  tm_dots(col = "precip", title="Precipitation [mm]")+
  tmap_options(basemaps = "https://wmts.geo.admin.ch/1.0.0/ch.swisstopo.swissimage/default/current/3857/{z}/{x}/{y}.jpeg")
```

Figure 18: map of the tracked locations of Caroline classified with precipitation


Compared to the temperature and seasons, the precipitation does not show off a remarkable difference between the seasons or in the use of habitat depending on precipitation. There are only some high precipitations, where Caroline uses small forests and some fields. Otherwise, it is difficult to see any difference, because of the general low precipitation.



## Discussion

The main findings of our project is that there is an influence of temperature and precipitation in the wild boar movement which even highlights a seasonal difference. Especially the seasonal difference between summer and winter is highlighted. In summer the wild boar movement has a  less clustered moving pattern and locations such as crops and fields are used as habitats. In winter the wild boars have a clustered moving pattern where they use the forest as their habitat. The results show that autumns and spring do not have a specific clustered moving pattern. Especially, in autumn the wild boars tend to move everywhere, because of the mild temperatures and the low precipitations.

As already said wild boars move the most in summer and autumn compared to the other seasons (Figure 9). Within the spring season higher temperatures do not affect the travelled distance per day, which means that the wild boar movement remains constant with increasing temperatures in spring On the other hand, one degree warmer in the winter season the wild boar movement increases remarkably. But overall the wild boar move less in winter, because of the low temperatures. Thus, one can say that higher temperatures increase and low temperatures decrease the wild boar movement. 

The statistical tests go along with the visual results that there is a seasonal difference. Especially, the difference between summer and winter is significant. Statistically, there is no significant difference between summer and autumn. Also, there are no difference between spring and the other seasons. Overall the tests verify that temperature has an influence on the wild boar movement. 

Precipitation generally caused increased movement in summer and decreased movement during winter. A suggested explanation for this finding may be that winter precipitation holds on for a longer time whereas summer precipitation holds on for a short period of time. Additionally, winter precipitation may increase the effect of cold weather (Thurfjell et al. 2014: 470). As Morelle et al. discussed (2015: 23) because of the snow depth in winter the wild boar movement decreases.
In contrary to the influence of temperature, the influence of precipitation is not shown clear enough, visually and statistically.
A seasonal difference between the precipitation in summer and winter is highlighted in the plots, which we already discussed before. This main finding leads us to the conclusion that precipitation does have an influence on the wild boar movement.

All these results were already studied from other authors, which were discussed in the literature review chapter. As we have expected from previous study, weather effects the wild boar movement and that there is a seasonal difference between winter and summer. 

## Limitations
One limitation of this project is the classification of the seasons. There are different classifications for seasons such as the meteorological division of seasons or astronomical seasons. In this project, we have chosen the meteorological division for simplicity. Thus, the results and the findings may have different results depending on the classification of seasons.

Another limitation of this project is the weather data. With some difficulty, we could get weather data from weather stations near the wild boar data. There were no available weather data from the exactt study area, where the wild boars moved. We could get data from weather stations, Neuchâtel and Cressier. Since both weather stations are near the study area from the wild boar data, we used the mean temperature and precipitation from both weather stations. Although we could use the available weather data for our project, it would have been accurate to use weather data from the study area of the wild boar data itself.

To analyse the difference between clustering and moving, a moving window was used for calculating the mean distance of between all tracking locations, similarly as we have learned it from the exercises. Here a moving window of 12 locations (6 preceding and 6 following points) was used. If that local mean was smaller than the global mean distance, the point was classified as "static". The higher the ratio of static values per day, the higher the clustering. Certainly, there are other possibilities to analyse the difference between clustering and moving regarding the wild boar data and the seasonal difference. We had some difficulties to apply the most appropriate method for our research question. 
Lastly, we decided to follow the method we used in the exercises and used the static value, which we found would be suitable for our project. Further we experimented with different window-sizes of the moving window, but didn't find any big differences.

Regarding the analysis about precipitation, there are lots of days with no precipitation in Neuchâtel and Cressier. Because of these 0 values in the data, the comparison between precipitation and movement (daily distance) is not clear. Thus, the interpretation of the influence of precipitation on wild boar movement is limited. As we can see from Figure 13, one can see that the precipitations trend here are dependent on the outliers, for which reason the uncertainty is bigger where the outliers are. 

The plots, where precipitation is analysed portray how many 0 values the weather data has. Therefore, the influence of precipitation on wild boar movement can only be interpreted based on some data values. If we look at the overview from the plots of each wild boar (Figure 16), one can see that not all wild boars have data for each season. For some animals, there are data missing, which must be questioned, if the data is missing or if the wild boars did not move in the respective seasons.

The different maps from the wild boar Caroline give an overview of the movement regarding season, temperature, and precipitation throughout the whole year. One can see how Caroline has moved, what kind of moving pattern the wild boar has and which habitat it uses mostly. To reassure our results from the other plots, this map helps to understand the differences and visualizes them. But a visualization from one wild boar movement only is not enough. The idea was to visualize and present the map from the three wild boars with the most measurements. Due to the big amount of data, the visualization was not possible. Therefore, that part of the analysis has to be taken with caution.


## Conclusion
In conclusion, in this project, we found out the that the temperature and precipitation influence the wild boar movement, where the seasonal difference between summer and winter is the highlight. With higher temperatures wild boar move more and with low temperatures the wild boar movement decreases. In summer, wild boars have a less clustered moving pattern, where they use different locations as their habitats. Whereas in winter, the wild boars move less and have a clustered moving pattern, where they only use some habitats.
In seasons autumn and spring wild boars have no significant moving pattern and they do use different habitats. The influence of precipitations shows that the movement in summer precipitation is higher than in winter precipitation, which is again dependent on the temperatures. The results from this project give a quick overview over the topic of wild boar movement and the effects of weather. This project reassures the main arguments, which were already stated in other studies and presents the main findings in a different way. 
For further research, analysis with canopies and detailed interpretations would be of great interest. Furthermore, to analyse the effects of weather on different animal movement and from different countries will help to understand the environment and the animals and their behavior better.


## References
Dardaillon, M. (1986): Seasonal Variations in Habitat Selection and Spatial Distribution of Wild Boar (Sus Scrofa) in the Camargue, Southern France. Behavioural Processes, 13, 251-268.

Lemel, J., Truve, J.& Soderberg, B. (2003): Variation in ranging and activity behaviour of European wild boar Sus scrofa in Sweden. Wildl Biol 9, 29–36.Mammal Review, 45, 15-29.

Morelle, K. Podgroski, T., Prévot, C., Keuling, O., Lehaire, F. & Leheune, P. (2014): Towards understanding wild boar Sus scrofa movement: a synthetic movement ecology approach. 

Thurfjell, H., Spong, G.& Ericsson, G. (2014): Effects of weather, season, and daylight on female wild boar movement. Acta Theriol, 59, 467-472.